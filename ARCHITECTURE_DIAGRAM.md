# InsightX Architecture with Supabase

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (Next.js)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   Landing    â”‚  â”‚   Connect    â”‚  â”‚   Reports    â”‚          â”‚
â”‚  â”‚     Page     â”‚â†’ â”‚     Page     â”‚â†’ â”‚     Page     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                           â†“                   â†“                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                    â”‚  Workspace   â”‚    â”‚   Report     â”‚         â”‚
â”‚                    â”‚     Page     â”‚    â”‚   Detail     â”‚         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                           â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚              React Hooks Layer                      â”‚         â”‚
â”‚  â”‚  useSession | useChats | useMessages | useSessions â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                           â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                 API Layer                           â”‚         â”‚
â”‚  â”‚  sessions.ts | chats.ts | messages.ts              â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                           â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚            Supabase Client (supabase.ts)           â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                           â†“                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTPS + Anon Key
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SUPABASE (Backend)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚              PostgreSQL Database                    â”‚         â”‚
â”‚  â”‚                                                      â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚         â”‚
â”‚  â”‚  â”‚ sessions â”‚  â”‚  chats   â”‚  â”‚ messages â”‚         â”‚         â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚         â”‚
â”‚  â”‚  â”‚ id       â”‚  â”‚ id       â”‚  â”‚ id       â”‚         â”‚         â”‚
â”‚  â”‚  â”‚ user_id  â”‚  â”‚ session  â”‚  â”‚ chat_id  â”‚         â”‚         â”‚
â”‚  â”‚  â”‚ filename â”‚  â”‚ title    â”‚  â”‚ role     â”‚         â”‚         â”‚
â”‚  â”‚  â”‚ status   â”‚  â”‚ created  â”‚  â”‚ content  â”‚         â”‚         â”‚
â”‚  â”‚  â”‚ data_dna â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ created  â”‚         â”‚         â”‚
â”‚  â”‚  â”‚ row_countâ”‚       â†‘        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚         â”‚
â”‚  â”‚  â”‚ created  â”‚       â”‚             â†‘                â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚             â”‚                â”‚         â”‚
â”‚  â”‚       â†‘             â”‚             â”‚                â”‚         â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚         â”‚
â”‚  â”‚              Foreign Keys                           â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                   â”‚
â”‚  Security: RLS Disabled (Anonymous Access)                       â”‚
â”‚  Region: ap-south-1 (Mumbai)                                     â”‚
â”‚  Status: ACTIVE_HEALTHY                                          â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagram

### 1. File Upload Flow
```
User selects CSV
      â†“
createSession(filename)
      â†“
sessions table
  status: 'uploading'
      â†“
Process file locally
(pandas/DuckDB)
      â†“
Generate Data DNA
      â†“
updateSessionDataDNA()
      â†“
sessions table
  status: 'ready'
  data_dna: {...}
      â†“
Navigate to /workspace/[id]
```

### 2. Chat Flow
```
User enters workspace
      â†“
useSession(sessionId)
      â†“
Load session + Data DNA
      â†“
useChatsBySession(sessionId)
      â†“
Display chat list
      â†“
User clicks "New Chat"
      â†“
createChat(sessionId)
      â†“
chats table
      â†“
User sends message
      â†“
createMessage(chatId, 'user', content)
      â†“
messages table
      â†“
[Future: Backend AI Response]
      â†“
createMessage(chatId, 'assistant', response)
      â†“
messages table
      â†“
useMessages(chatId) - auto refresh
      â†“
Display in UI
```

### 3. Reports Flow
```
User visits /reports
      â†“
useSessions()
      â†“
getAllSessions('anonymous')
      â†“
sessions table
      â†“
Display session cards
      â†“
User clicks session
      â†“
Navigate to /reports/[id]
      â†“
useSession(sessionId)
useChatsBySession(sessionId)
      â†“
Display session details + chats
```

---

## File Structure

```
insightx-app/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx                    # Landing page
â”‚   â”œâ”€â”€ connect/
â”‚   â”‚   â””â”€â”€ page.tsx                # File upload â†’ createSession()
â”‚   â”œâ”€â”€ workspace/
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â””â”€â”€ page.tsx            # Chat interface â†’ useSession, useChats, useMessages
â”‚   â””â”€â”€ reports/
â”‚       â”œâ”€â”€ page.tsx                # Session list â†’ useSessions()
â”‚       â””â”€â”€ [id]/
â”‚           â””â”€â”€ page.tsx            # Session detail â†’ useSession()
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase.ts                 # Supabase client + types
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ sessions.ts             # CRUD for sessions
â”‚   â”‚   â”œâ”€â”€ chats.ts                # CRUD for chats
â”‚   â”‚   â”œâ”€â”€ messages.ts             # CRUD for messages
â”‚   â”‚   â””â”€â”€ index.ts                # Barrel export
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useSession.ts           # React hook for sessions
â”‚   â”‚   â”œâ”€â”€ useChats.ts             # React hook for chats
â”‚   â”‚   â”œâ”€â”€ useMessages.ts          # React hook for messages
â”‚   â”‚   â””â”€â”€ index.ts                # Barrel export
â”‚   â””â”€â”€ test-connection.ts          # Test script
â”‚
â”œâ”€â”€ store/
â”‚   â”œâ”€â”€ dataStore.ts                # UI state (simplified)
â”‚   â”œâ”€â”€ chatStore.ts                # UI state (simplified)
â”‚   â””â”€â”€ workspaceStore.ts           # UI state only
â”‚
â”œâ”€â”€ .env.local                      # Supabase credentials
â”œâ”€â”€ SUPABASE_INTEGRATION.md         # API docs
â”œâ”€â”€ INTEGRATION_GUIDE.md            # How-to guide
â”œâ”€â”€ SUPABASE_SETUP_COMPLETE.md      # Setup summary
â””â”€â”€ ARCHITECTURE_DIAGRAM.md         # This file
```

---

## API Layer Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Component Layer                           â”‚
â”‚  (React components use hooks for data fetching)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Hooks Layer                              â”‚
â”‚  â€¢ useSession(id) â†’ getSession(id)                          â”‚
â”‚  â€¢ useSessions() â†’ getAllSessions()                         â”‚
â”‚  â€¢ useChats(sessionId) â†’ getChatsBySession(sessionId)       â”‚
â”‚  â€¢ useMessages(chatId) â†’ getMessagesByChat(chatId)          â”‚
â”‚                                                              â”‚
â”‚  Provides: { data, loading, error, refetch }                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API Layer                               â”‚
â”‚  â€¢ sessions.ts â†’ createSession, getSession, update, delete  â”‚
â”‚  â€¢ chats.ts â†’ createChat, getChat, update, delete           â”‚
â”‚  â€¢ messages.ts â†’ createMessage, getMessages, delete         â”‚
â”‚                                                              â”‚
â”‚  Returns: Promise<Data> or throws Error                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Supabase Client                             â”‚
â”‚  â€¢ Handles authentication (anon key)                         â”‚
â”‚  â€¢ Manages connections                                       â”‚
â”‚  â€¢ Provides type safety                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Supabase Backend                            â”‚
â”‚  â€¢ PostgreSQL database                                       â”‚
â”‚  â€¢ REST API                                                  â”‚
â”‚  â€¢ Real-time subscriptions (future)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      users       â”‚
â”‚  (not used yet)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ user_id (FK)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    sessions      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â€¢ id (PK)        â”‚
â”‚ â€¢ user_id (FK)   â”‚
â”‚ â€¢ filename       â”‚
â”‚ â€¢ status         â”‚
â”‚ â€¢ data_dna       â”‚â—„â”€â”€â”€ JSONB column stores complete Data DNA
â”‚ â€¢ row_count      â”‚
â”‚ â€¢ created_at     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ session_id (FK)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      chats       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â€¢ id (PK)        â”‚
â”‚ â€¢ session_id(FK) â”‚
â”‚ â€¢ title          â”‚
â”‚ â€¢ created_at     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ chat_id (FK)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    messages      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â€¢ id (PK)        â”‚
â”‚ â€¢ chat_id (FK)   â”‚
â”‚ â€¢ role           â”‚â—„â”€â”€â”€ 'user' | 'assistant'
â”‚ â€¢ content        â”‚
â”‚ â€¢ created_at     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Current Setup                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Authentication: NONE (Anonymous access)                     â”‚
â”‚  User ID: 'anonymous' (hardcoded)                           â”‚
â”‚                                                              â”‚
â”‚  RLS Status:                                                 â”‚
â”‚  â€¢ users table: ENABLED (not used)                          â”‚
â”‚  â€¢ sessions table: DISABLED                                  â”‚
â”‚  â€¢ chats table: DISABLED                                     â”‚
â”‚  â€¢ messages table: DISABLED                                  â”‚
â”‚                                                              â”‚
â”‚  Access: Anyone with anon key can read/write all data       â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Future Setup                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Authentication: Supabase Auth (email/password, OAuth)       â”‚
â”‚  User ID: Real user UUIDs                                    â”‚
â”‚                                                              â”‚
â”‚  RLS Policies:                                               â”‚
â”‚  â€¢ Users can only see their own sessions                     â”‚
â”‚  â€¢ Users can only see chats for their sessions              â”‚
â”‚  â€¢ Users can only see messages for their chats              â”‚
â”‚                                                              â”‚
â”‚  Migration: Enable RLS + add policies when auth is ready    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Environment Configuration

```
Development (.env.local):
â”œâ”€â”€ NEXT_PUBLIC_SUPABASE_URL
â”‚   â””â”€â”€ https://xvtqbvavwbowyyoevolo.supabase.co
â””â”€â”€ NEXT_PUBLIC_SUPABASE_ANON_KEY
    â””â”€â”€ eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

Production (.env.production):
â”œâ”€â”€ NEXT_PUBLIC_SUPABASE_URL (same)
â””â”€â”€ NEXT_PUBLIC_SUPABASE_ANON_KEY (same)

Note: Anon key is safe to expose in frontend
```

---

## Future Backend Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FastAPI Backend                           â”‚
â”‚                   (To be implemented)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  POST /api/upload                                            â”‚
â”‚  â”œâ”€â”€ Accept CSV file                                         â”‚
â”‚  â”œâ”€â”€ Create session in Supabase                             â”‚
â”‚  â”œâ”€â”€ Upload to R2/Supabase Storage                          â”‚
â”‚  â””â”€â”€ Return session_id                                       â”‚
â”‚                                                              â”‚
â”‚  POST /api/explore/{session_id}                             â”‚
â”‚  â”œâ”€â”€ Download CSV from storage                              â”‚
â”‚  â”œâ”€â”€ Run pandas/DuckDB profiling                            â”‚
â”‚  â”œâ”€â”€ Generate Data DNA                                       â”‚
â”‚  â””â”€â”€ Update session in Supabase                             â”‚
â”‚                                                              â”‚
â”‚  POST /api/message                                           â”‚
â”‚  â”œâ”€â”€ Save user message to Supabase                          â”‚
â”‚  â”œâ”€â”€ Call AI orchestrator                                    â”‚
â”‚  â”œâ”€â”€ Execute SQL/Python                                      â”‚
â”‚  â”œâ”€â”€ Save assistant response to Supabase                    â”‚
â”‚  â””â”€â”€ Return response                                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary

âœ… **Frontend** â†’ Supabase connection established  
âœ… **Database** â†’ Schema created with proper relationships  
âœ… **API Layer** â†’ Clean functions for all operations  
âœ… **React Hooks** â†’ Easy data fetching in components  
âœ… **Security** â†’ Anonymous access configured  
âœ… **Documentation** â†’ Complete guides and examples  

**Next:** Integrate the API into your existing pages and build the backend! ğŸš€
